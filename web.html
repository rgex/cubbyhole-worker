<html>
    <style>
	.content {
		width: 850px;
		margin-left:auto;
		margin-right:auto;
	}
        .fileExplorer .element .type {
            display: block;
            width : 40px;
            max-width : 40px;
            float: left;
        }
	.fileExplorer .element .name {
            display: block;
            width : 450px;
            max-width : 450px;
            float: left;
        }
	.fileExplorer .element-0 {

	}
	.fileExplorer .element-1 {
		background-color: #f5f5f5;
	}
    </style>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="jquery-1.11.1.min.js"></script>
    <script>
        currentPath = new Array(); //stack like
        token = '';
        wsUrl = 'http://127.0.0.1:3000/';
        
        /**
         *  @param Array
         *
         *  @returns String
         */
        function pathToString(path) {
            var pathString = path.join('/');
	    if(pathString.length > 1)
		pathString = "/" + pathString + "/";
            return pathString;
        }

	function gotoFolderInPath(i) {
		currentPath = currentPath.slice(0, i);
		getPathListFromWS(currentPath);
	}
        function getPathListFromWS(path) {
            $.ajax({
                type: "POST",
                url: wsUrl + 'list',
                data: 'path=' + pathToString(path),
                success: function(data){
                    displayPath(data,path);
                },
                dataType: 'json'
              });
        }
        
        function listPath(folder) {
            newPath = currentPath;
            newPath.push(folder);
            getPathListFromWS(currentPath);
        }

        function listParentPath(path) {
        	
        }
        
	function clickOnFolder(folder){
		listPath(folder);
	}

	function refreshNaBar() {
	  	//first remove all previous elements
	   	$('.navTab').html('');
		$('.navTab').append('<span><a href="#" onclick="gotoFolderInPath(0); return false;">Home</a></span> / ');
		for(var i in currentPath) {
			$('.navTab').append('<li><a href="#" onclick="gotoFolderInPath(' + (i+1) + '); return false;">' + currentPath[i] + '</a></li>');
		}
	}

	function downloadFile() {

	}

        function displayPath(json,newPath) {
	    //first remove all previous elements

	    $('.fileExplorer').html('');
	    
            for(i in json) {
		if(json[i][0] == 'D') { //directory
                	$('.fileExplorer').append('<div class="element element-' + i%2 + '" style="background-color:#ff0000">'+
                                         	  '<span class="type"><img src="img/folder.gif"></span>' +
						  '<span class="name"><a href="#" onclick="listPath(\'' + json[i][1] + '\'); return false;">' + json[i][1] + '</a></span>' +
						  '<span class="delete"></span>' +
						  '<span class="download"></span>' +
 			                          '</div>' +
						  '<div style="clear:both;"></div>');
		}
		else {	//file
                	$('.fileExplorer').append('<div class="element element-' + i%2 + '">'+
                                         	  '<span class="type"><img src="img/file.png"></span>' +
                                         	  '<span class="name">' + json[i][1] + '</span>' +
						  '<span class="delete"></span>' +
						  '<span class="download"><a href="#" onclick="clickOnFolder(\'' + json[i][1] + '\'); return false;">download</a></span>' +
                                         	  '</div>'+
						  '<div style="clear:both;"></div>');
		}
            }
            currentPath = newPath;
	    refreshNaBar();
        }
        
        
        $( document ).ready(function() {
            getPathListFromWS(currentPath);
        });


    </script>
<div class="content">
    <div class="actionTab">
<button>New Folder</button>

<br/>
    </div>
    <ol class="navTab breadcrumb">

    </ol>
    <div class='fileExplorer'>
        
    </div>
</div>
</html>
